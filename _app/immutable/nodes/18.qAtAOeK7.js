import{s as Ae,n as re,d as i,i as R,b as l,c as d,e as h,f as y,k as p,v as Ie,r as Ce,a as U,p as de,g as se,h as A,j as L,l as I,t as V,w as He}from"../chunks/DUYTDFI5.js";import{e as we}from"../chunks/fXUx-Agj.js";import{S as Me,i as Se}from"../chunks/z4FfSzan.js";import{g as Ee}from"../chunks/8955DNq9.js";import{a as Te}from"../chunks/BF9jo3u2.js";function De(a,e,t){const s=a.slice();return s[7]=e[t],s}function Ue(a){let e,t;return{c(){e=p("div"),t=V(a[2]),this.h()},l(s){e=h(s,"DIV",{class:!0});var n=y(e);t=L(n,a[2]),n.forEach(i),this.h()},h(){d(e,"class","bg-red-100 text-red-700 p-4 rounded mt-12 text-center")},m(s,n){R(s,e,n),l(e,t)},p(s,n){n&4&&U(t,s[2])},d(s){s&&i(e)}}}function je(a){let e,t,s,n="Ticket Management",o,r,_,g=a[1]?"Loading...":"Add tickets",E,k,b,w=a[1]?"Loading...":"Refresh",C,H,j,M;function N(m,x){return m[1]?Oe:m[0].length===0?ze:Be}let S=N(a),D=S(a);return{c(){e=p("div"),t=p("div"),s=p("h1"),s.textContent=n,o=I(),r=p("div"),_=p("button"),E=V(g),k=I(),b=p("button"),C=V(w),H=I(),D.c(),this.h()},l(m){e=h(m,"DIV",{class:!0});var x=y(e);t=h(x,"DIV",{class:!0});var v=y(t);s=h(v,"H1",{class:!0,"data-svelte-h":!0}),se(s)!=="svelte-1g4shuu"&&(s.textContent=n),o=A(v),r=h(v,"DIV",{class:!0});var c=y(r);_=h(c,"BUTTON",{class:!0});var T=y(_);E=L(T,g),T.forEach(i),k=A(c),b=h(c,"BUTTON",{class:!0});var f=y(b);C=L(f,w),f.forEach(i),c.forEach(i),v.forEach(i),H=A(x),D.l(x),x.forEach(i),this.h()},h(){d(s,"class","text-3xl font-bold text-blue-whale"),_.disabled=a[1],d(_,"class","bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 disabled:opacity-50"),b.disabled=a[1],d(b,"class","bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 disabled:opacity-50"),d(r,"class","flex gap-2"),d(t,"class","flex justify-between items-center mb-6"),d(e,"class","bg-white rounded-lg shadow-md p-8 mt-16")},m(m,x){R(m,e,x),l(e,t),l(t,s),l(t,o),l(t,r),l(r,_),l(_,E),l(r,k),l(r,b),l(b,C),l(e,H),D.m(e,null),j||(M=[de(_,"click",a[5]),de(b,"click",a[3])],j=!0)},p(m,x){x&2&&g!==(g=m[1]?"Loading...":"Add tickets")&&U(E,g),x&2&&(_.disabled=m[1]),x&2&&w!==(w=m[1]?"Loading...":"Refresh")&&U(C,w),x&2&&(b.disabled=m[1]),S===(S=N(m))&&D?D.p(m,x):(D.d(1),D=S(m),D&&(D.c(),D.m(e,null)))},d(m){m&&i(e),D.d(),j=!1,Ce(M)}}}function Be(a){let e,t,s,n='<tr><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Code</th> <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">User</th> <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Email</th> <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Association</th> <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Dietary Wishes</th> <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Special Needs</th> <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Created</th> <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Email Verified</th> <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th></tr>',o,r,_,g,E,k,b=a[0].length+"",w,C,H=a[0].length!==1?"s":"",j,M,N,S,D=new Date().toLocaleTimeString()+"",m,x=we(a[0]),v=[];for(let c=0;c<x.length;c+=1)v[c]=Le(De(a,x,c));return{c(){e=p("div"),t=p("table"),s=p("thead"),s.innerHTML=n,o=I(),r=p("tbody");for(let c=0;c<v.length;c+=1)v[c].c();_=I(),g=p("div"),E=p("div"),k=V("Showing "),w=V(b),C=V(" ticket"),j=V(H),M=I(),N=p("div"),S=V("Last updated: "),m=V(D),this.h()},l(c){e=h(c,"DIV",{class:!0});var T=y(e);t=h(T,"TABLE",{class:!0});var f=y(t);s=h(f,"THEAD",{class:!0,"data-svelte-h":!0}),se(s)!=="svelte-1b2alal"&&(s.innerHTML=n),o=A(f),r=h(f,"TBODY",{class:!0});var z=y(r);for(let F=0;F<v.length;F+=1)v[F].l(z);z.forEach(i),f.forEach(i),T.forEach(i),_=A(c),g=h(c,"DIV",{class:!0});var W=y(g);E=h(W,"DIV",{class:!0});var B=y(E);k=L(B,"Showing "),w=L(B,b),C=L(B," ticket"),j=L(B,H),B.forEach(i),M=A(W),N=h(W,"DIV",{class:!0});var P=y(N);S=L(P,"Last updated: "),m=L(P,D),P.forEach(i),W.forEach(i),this.h()},h(){d(s,"class","bg-gray-50"),d(r,"class","bg-white divide-y divide-gray-200"),d(t,"class","min-w-full divide-y divide-gray-200"),d(e,"class","overflow-x-auto"),d(E,"class","text-sm text-gray-500"),d(N,"class","text-sm text-gray-500"),d(g,"class","mt-6 flex justify-between items-center")},m(c,T){R(c,e,T),l(e,t),l(t,s),l(t,o),l(t,r);for(let f=0;f<v.length;f+=1)v[f]&&v[f].m(r,null);R(c,_,T),R(c,g,T),l(g,E),l(E,k),l(E,w),l(E,C),l(E,j),l(g,M),l(g,N),l(N,S),l(N,m)},p(c,T){if(T&17){x=we(c[0]);let f;for(f=0;f<x.length;f+=1){const z=De(c,x,f);v[f]?v[f].p(z,T):(v[f]=Le(z),v[f].c(),v[f].m(r,null))}for(;f<v.length;f+=1)v[f].d(1);v.length=x.length}T&1&&b!==(b=c[0].length+"")&&U(w,b),T&1&&H!==(H=c[0].length!==1?"s":"")&&U(j,H)},d(c){c&&(i(e),i(_),i(g)),He(v,c)}}}function ze(a){let e,t='<div class="text-gray-500 text-lg">No tickets found</div>';return{c(){e=p("div"),e.innerHTML=t,this.h()},l(s){e=h(s,"DIV",{class:!0,"data-svelte-h":!0}),se(e)!=="svelte-rpdel9"&&(e.innerHTML=t),this.h()},h(){d(e,"class","text-center py-12")},m(s,n){R(s,e,n)},p:re,d(s){s&&i(e)}}}function Oe(a){let e,t='<div class="text-gray-500">Loading tickets...</div>';return{c(){e=p("div"),e.innerHTML=t,this.h()},l(s){e=h(s,"DIV",{class:!0,"data-svelte-h":!0}),se(e)!=="svelte-pn60z7"&&(e.innerHTML=t),this.h()},h(){d(e,"class","flex justify-center items-center py-12")},m(s,n){R(s,e,n)},p:re,d(s){s&&i(e)}}}function Le(a){var he,pe,_e,me,ve;let e,t,s,n=a[7].code+"",o,r,_,g,E=((he=a[7].user)==null?void 0:he.name)+"",k,b,w,C=((pe=a[7].user)==null?void 0:pe.email)+"",H,j,M,N=(a[7].association||"N/A")+"",S,D,m,x=(((_e=a[7].user)==null?void 0:_e.dietaryWishes)||"None")+"",v,c,T,f=(((me=a[7].user)==null?void 0:me.needs)||"None")+"",z,W,B,P=Ve(a[7].createdAt)+"",F,ie,G,Y,K=(ve=a[7].user)!=null&&ve.emailVerified?"Verified":"Unverified",le,ae,ne,J,q,ue='<i class="fa-solid fa-trash text-red-500"></i>',oe,ce,fe;function Ne(){return a[6](a[7])}return{c(){e=p("tr"),t=p("td"),s=p("span"),o=V(n),_=I(),g=p("td"),k=V(E),b=I(),w=p("td"),H=V(C),j=I(),M=p("td"),S=V(N),D=I(),m=p("td"),v=V(x),c=I(),T=p("td"),z=V(f),W=I(),B=p("td"),F=V(P),ie=I(),G=p("td"),Y=p("span"),le=V(K),ne=I(),J=p("td"),q=p("button"),q.innerHTML=ue,oe=I(),this.h()},l(O){e=h(O,"TR",{class:!0});var u=y(e);t=h(u,"TD",{class:!0});var Q=y(t);s=h(Q,"SPAN",{title:!0});var X=y(s);o=L(X,n),X.forEach(i),Q.forEach(i),_=A(u),g=h(u,"TD",{class:!0});var Z=y(g);k=L(Z,E),Z.forEach(i),b=A(u),w=h(u,"TD",{class:!0});var $=y(w);H=L($,C),$.forEach(i),j=A(u),M=h(u,"TD",{class:!0});var ee=y(M);S=L(ee,N),ee.forEach(i),D=A(u),m=h(u,"TD",{class:!0});var te=y(m);v=L(te,x),te.forEach(i),c=A(u),T=h(u,"TD",{class:!0});var ge=y(T);z=L(ge,f),ge.forEach(i),W=A(u),B=h(u,"TD",{class:!0});var xe=y(B);F=L(xe,P),xe.forEach(i),ie=A(u),G=h(u,"TD",{class:!0});var ye=y(G);Y=h(ye,"SPAN",{class:!0});var be=y(Y);le=L(be,K),be.forEach(i),ye.forEach(i),ne=A(u),J=h(u,"TD",{class:!0});var ke=y(J);q=h(ke,"BUTTON",{class:!0,"data-svelte-h":!0}),se(q)!=="svelte-oz22k2"&&(q.innerHTML=ue),ke.forEach(i),oe=A(u),u.forEach(i),this.h()},h(){var O;d(s,"title",r=a[7].code),d(t,"class","px-6 py-4 whitespace-nowrap text-sm text-gray-500 font-mono"),d(g,"class","px-6 py-4 whitespace-nowrap text-sm text-gray-900"),d(w,"class","px-6 py-4 whitespace-nowrap text-sm text-gray-500"),d(M,"class","px-6 py-4 whitespace-nowrap text-sm text-gray-500"),d(m,"class","px-6 py-4 whitespace-nowrap text-sm text-gray-500"),d(T,"class","px-6 py-4 whitespace-nowrap text-sm text-gray-500"),d(B,"class","px-6 py-4 whitespace-nowrap text-sm text-gray-500"),d(Y,"class",ae="inline-flex px-2 py-1 text-xs font-semibold rounded-full "+((O=a[7].user)!=null&&O.emailVerified?"bg-green-100 text-green-800":"bg-red-100 text-red-800")),d(G,"class","px-6 py-4 whitespace-nowrap"),d(q,"class","cursor-pointer"),d(J,"class","px-6 py-4 whitespace-nowrap"),d(e,"class","hover:bg-gray-50")},m(O,u){R(O,e,u),l(e,t),l(t,s),l(s,o),l(e,_),l(e,g),l(g,k),l(e,b),l(e,w),l(w,H),l(e,j),l(e,M),l(M,S),l(e,D),l(e,m),l(m,v),l(e,c),l(e,T),l(T,z),l(e,W),l(e,B),l(B,F),l(e,ie),l(e,G),l(G,Y),l(Y,le),l(e,ne),l(e,J),l(J,q),l(e,oe),ce||(fe=de(q,"click",Ne),ce=!0)},p(O,u){var Q,X,Z,$,ee,te;a=O,u&1&&n!==(n=a[7].code+"")&&U(o,n),u&1&&r!==(r=a[7].code)&&d(s,"title",r),u&1&&E!==(E=((Q=a[7].user)==null?void 0:Q.name)+"")&&U(k,E),u&1&&C!==(C=((X=a[7].user)==null?void 0:X.email)+"")&&U(H,C),u&1&&N!==(N=(a[7].association||"N/A")+"")&&U(S,N),u&1&&x!==(x=(((Z=a[7].user)==null?void 0:Z.dietaryWishes)||"None")+"")&&U(v,x),u&1&&f!==(f=((($=a[7].user)==null?void 0:$.needs)||"None")+"")&&U(z,f),u&1&&P!==(P=Ve(a[7].createdAt)+"")&&U(F,P),u&1&&K!==(K=(ee=a[7].user)!=null&&ee.emailVerified?"Verified":"Unverified")&&U(le,K),u&1&&ae!==(ae="inline-flex px-2 py-1 text-xs font-semibold rounded-full "+((te=a[7].user)!=null&&te.emailVerified?"bg-green-100 text-green-800":"bg-red-100 text-red-800"))&&d(Y,"class",ae)},d(O){O&&i(e),ce=!1,fe()}}}function Pe(a){let e,t;function s(r,_){return r[2]?Ue:je}let n=s(a),o=n(a);return{c(){e=p("div"),t=p("div"),o.c(),this.h()},l(r){e=h(r,"DIV",{class:!0});var _=y(e);t=h(_,"DIV",{class:!0});var g=y(t);o.l(g),g.forEach(i),_.forEach(i),this.h()},h(){d(t,"class","max-w-7xl mx-auto"),d(e,"class","min-h-screen bg-bottom-backdrop p-8")},m(r,_){R(r,e,_),l(e,t),o.m(t,null)},p(r,[_]){n===(n=s(r))&&o?o.p(r,_):(o.d(1),o=n(r),o&&(o.c(),o.m(t,null)))},i:re,o:re,d(r){r&&i(e),o.d()}}}function Ve(a){return new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}function Re(a,e,t){let s=[],n=!0,o="";Ie(async()=>{await r()});async function r(){t(1,n=!0),t(2,o="");try{const k=await fetch(Te("/ticket"),{credentials:"include"});k.ok?t(0,s=await k.json()):t(2,o=k.status===401?"Unauthorized":"Failed to load tickets")}catch(k){t(2,o="Network error occurred"),console.error("Error fetching tickets:",k)}finally{t(1,n=!1)}}const _=async k=>{if(confirm("Are you sure you want to delete this ticket?")){t(1,n=!0),t(2,o="");try{const b=await fetch(Te(`/ticket/${k}`),{method:"DELETE",credentials:"include"});if(b.ok)t(0,s=s.filter(w=>w.id!==k));else if(b.status===401)t(2,o="Unauthorized"),Ee("/login");else{const w=await b.text().catch(()=>"");t(2,o=`Failed to delete ticket${w?": "+w:""}`)}}catch(b){t(2,o="Network error occurred"),console.error("Error deleting ticket:",b)}finally{t(1,n=!1)}}};return[s,n,o,r,_,()=>Ee("/tickets/create"),k=>_(k.id)]}class Je extends Me{constructor(e){super(),Se(this,e,Re,Pe,Ae,{})}}export{Je as component};
